<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <meta name="theme-color" content="#317EFB"/>
  <title>Hugo shortcode to serve images in next-gen formats</title>
  <meta property="og:title" content="Hugo shortcode to serve images in next-gen formats" />
  <meta name="twitter:title" content="Hugo shortcode to serve images in next-gen formats" />
  <meta name="description" content="Hugo shortcode to serve images in next-gen formatsIn my last blogpost I shared 10 ways to improve your Hugo website performance. My last tip was to serve images in next-gen formats. This could improve the performance of your website significantly. Eventhough there are multiple next-gen formats you can integrate, the best browser compatibility will come by using WebP, created by Google. Unfortunately, not all browsers support this format yet (looking at you, Safari!">
  <meta property="og:description" content="Hugo shortcode to serve images in next-gen formatsIn my last blogpost I shared 10 ways to improve your Hugo website performance. My last tip was to serve images in next-gen formats. This could improve the performance of your website significantly. Eventhough there are multiple next-gen formats you can integrate, the best browser compatibility will come by using WebP, created by Google. Unfortunately, not all browsers support this format yet (looking at you, Safari!">
  <meta name="twitter:description" content="Hugo shortcode to serve images in next-gen formatsIn my last blogpost I shared 10 ways to improve your Hugo website performance. My last tip was to serve images in next-gen formats. This could …">
  <meta name="author" content="Martijn van Vreeden"/>
  <link href='https://martijnvv.github.io/personal_blog/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://martijnvv.github.io/personal_blog/img/logo.jpg" />
  <meta name="twitter:image" content="https://martijnvv.github.io/personal_blog/img/logo.jpg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@martijnvv" />
  <meta name="twitter:creator" content="@martijnvv" />
  <meta property="og:url" content="https://martijnvv.github.io/personal_blog/hugo-shortcode-to-serve-images-in-next-gen-formats/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Martijn van Vreeden" />
  <meta name="google-site-verification" content="9jGR4dFHGBlfB9kcaGTSmzbtXMpxU3strfXQFQFHlkA" />
  <link href="https://fonts.googleapis.com" rel="preconnect" crossorigin>
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link href="https://maxcdn.bootstrapcdn.com" rel="preconnect" crossorigin>
  <link rel="dns-prefetch" href="https://maxcdn.bootstrapcdn.com">  
  <link href="https://www.google-analytics.com" rel="preconnect" crossorigin>
  <link rel="dns-prefetch" href="https://www.google-analytics.com">  
<link href='https://www.googletagmanager.com' rel="preconnect" crossorigin>
  <link rel="dns-prefetch" href='https://www.googletagmanager.com'>  <script>
	window.dataLayer = window.dataLayer || [];
	window.dataLayer.push({
		'pagePublishDate': '2020-03-28',
		'pageModifiedDate': '2020-03-28','pageReadingTimeMinutes':  4 ,
		'pageReadingTimeSeconds': 226 ,
		'pageWordCount': 827 ,
		'pageFuzzyWordCount': 900 ,
		'pageKind': 'page',
		'pageId': 'd035b471f6af15730b4392853d7e86a6',
		'pageTitle': 'Hugo shortcode to serve images in next-gen formats',
		'pagePermalink': 'https:\/\/martijnvv.github.io\/personal_blog\/hugo-shortcode-to-serve-images-in-next-gen-formats\/',
		'pageType': 'post',
		'pageTranslated':  false ,'pageAuthor': 'Martijn van Vreeden','pageCategory':'hugo','pageTags':'hugo','pageType2': 'post',
		'pageLanguage': 'en'
	 });
  </script>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-NMSG6Q');</script>
	

<meta name="generator" content="Hugo 0.110.0"><link rel="canonical" href="https://martijnvv.github.io/personal_blog/hugo-shortcode-to-serve-images-in-next-gen-formats/" />
  <script type="text/javascript">
          var stylesheet = document.createElement('link');
          stylesheet.href = 'https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css';
          stylesheet.rel = 'stylesheet';
          stylesheet.type = 'text/css';
          document.getElementsByTagName('head')[0].appendChild(stylesheet);
   </script> 
  <link rel="stylesheet" href="/css/main.css"/>
  <link href="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
    
  <script type="application/ld+json">
		{
			"@context":"http://schema.org/",
			"@type":"BlogPosting",
			"mainEntityOfPage":"https:\/\/martijnvv.github.io\/personal_blog\/hugo-shortcode-to-serve-images-in-next-gen-formats\/",
			"editor": "Martijn van Vreeden",
			"url":"https:\/\/martijnvv.github.io\/personal_blog\/hugo-shortcode-to-serve-images-in-next-gen-formats\/","headline":"Hugo shortcode to serve images in next-gen formats","description":"Hugo shortcode to serve images in next-gen formats\rIn my last blogpost I shared 10 ways to improve your Hugo website performance. My last tip was to serve images in next-gen formats. This could improve the performance of your website significantly. Eventhough there are multiple next-gen formats you can integrate, the best browser compatibility will come by using WebP, created by Google. Unfortunately, not all browsers support this format yet (looking at you, Safari!",
			"articleSection":"hugo",
			"timeRequired": "PT4M",
			"inLanguage" : "en",
			"wordCount":  827 ,
			"datePublished" : "2020-03-28T00:00:00",
			"dateModified" : "2020-03-28T00:00:00",
			"image":{
				"@type": "ImageObject",
				"url": "https:\/\/www.martijnvanvreeden.nl\/img\/logo.jpg",
				"name":"Hugo shortcode to serve images in next-gen formats",
				"width": "450",
				"height": "450"
			},
			"publisher": {
				"@type": "Organization",
				"name": "Martijn van Vreeden's Blog",
				"logo": {
					"@type": "ImageObject",
					"url": "https:\/\/www.martijnvanvreeden.nl\/img\/logo.jpg",
					"height": "450",
					"width": "450"
				}
			},
			"author": {
				"@type":"Person",
				"name":"Martijn van Vreeden",
				"image":"https:\/\/www.martijnvanvreeden.nl\/img\/logo.jpg",
				"url":"https:\/\/www.martijnvanvreeden.nl",
				"description":"I’m an independent digital analyst, based in Amersfoort, the Netherlands. I have 10+ years experience in digital marketing and digital analytics, with a focus on leveraging digital data to grow companies.",
				"sameAs":["https:\/\/www.linkedin.com\/in\/martijnvanvreeden\/", "https:\/\/https://twitter.com\/martijnvv"]
			}
		}
  </script>
</head>


  <body>
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-NMSG6Q" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://martijnvv.github.io/personal_blog/">Martijn van Vreeden</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="About me" href="/personal_blog/about-me/">About me</a>
            </li>
          
        
          
            <li>
              <a title="Clients" href="/personal_blog/portfolio/">Clients</a>
            </li>
          
        
          
            <li>
              <a title="GitHub" href="https://github.com/martijnvv">GitHub</a>
            </li>
          
        
          
            <li>
              <a title="LinkedIn" href="https://www.linkedin.com/in/martijnvanvreeden/">LinkedIn</a>
            </li>
          
        
          
            <li>
              <a title="Twitter" href="https://twitter.com/martijnvv">Twitter</a>
            </li>
          
        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="Martijn van Vreeden" href="https://martijnvv.github.io/personal_blog/">
		 <figure>
			<picture>
				<source srcset="/img/martijn-van-vreeden.webp" type="image/webp">
		  		<img class="avatar-img" loading="lazy" defer src="/img/martijn-van-vreeden.jpg" alt="Martijn van Vreeden" height="100px" width="100px"/>
			</picture>
		</figure>	
          </a>
        
      </div>
    </div>

  </div>
</nav>

    

  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    <div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post" id="content-item">
		
	  
        


<div id="hugo-shortcode-to-serve-images-in-next-gen-formats" class="section level1">
<h1>Hugo shortcode to serve images in next-gen formats</h1>
<p>In my last blogpost I shared <a href="/10-ways-to-improve-your-hugo-website-performance/">10 ways to improve your Hugo website performance</a>. My last tip was to serve images in next-gen formats. This could improve the performance of your website significantly. Eventhough there are multiple next-gen formats you can integrate, the best browser compatibility will come by using WebP, created by Google. Unfortunately, not all browsers support this format yet (looking at you, Safari!). To make sure you will serve an alternative, normal format like jpg or png instead for those non-compatible browsers, you need to update the way you serve your images and provide both formats.</p>
<p>In this article I share the shortcode you can use to do this and give you step-by-step instructions on how to create the images and add them to your markdown files for next-gen compatibility.</p>
<div id="the-html-output-for-an-image-with-multiple-image-types" class="section level2">
<h2>The HTML output for an image with multiple image types</h2>
<p>Traditionally, when you would like to include an image, you would create the following HTML element.</p>
<pre class="r"><code>&lt;img src=&quot;image.jpg&quot; alt=&quot;my image&quot; /&gt;</code></pre>
<p>There is also a HTML5 version of this same image, which is more flexible for many purposes, like responsiveness. The HTML5 version includes the figure element, which includes a picture and optional figcaption element.</p>
<pre class="r"><code>&lt;figure&gt;
    &lt;picture&gt;
      &lt;img src=&quot;image.jpg&quot; alt=&quot;my image&quot;&gt;
    &lt;/picture&gt;
    &lt;figcaption&gt;
      &lt;p class=&quot;caption&quot;&gt;Image caption text&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;</code></pre>
<p>To provide the option of alternative image types, for one image, you can add the source element, with an srcset item. Whenever the image type in this source element is supported, the browser will use it. Otherwise it will use your fallback option provided in the img element. A great way to include WebP as a primary image and a jpg as a backup.</p>
<pre class="r"><code>&lt;figure&gt;
    &lt;picture&gt;
    &lt;source srcset=&quot;image.webp&quot; type=&quot;image/webp&quot;&gt;
      &lt;img src=&quot;image.jpg&quot; alt=&quot;my image&quot;&gt;
    &lt;/picture&gt;
    &lt;figcaption&gt;
      &lt;p class=&quot;caption&quot;&gt;Image caption text&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;</code></pre>
</div>
<div id="shortcode-next-gen-images-hugo" class="section level2">
<h2>Shortcode next-gen images Hugo</h2>
<p>A shortcode is a simple snippet inside a content file that Hugo will render using a predefined template. Note that shortcodes will not work in template files. If you need the type of drop-in functionality that shortcodes provide but in a template, you most likely want a partial template instead.</p>
<p>This video gives a brief introduction to Hugo shortcodes and how to create your own.</p>
<div class="embed-responsive embed-responsive-16by9">
  <iframe src="https://www.youtube.com/embed/2xkNJL4gJ9E?enablejsapi=1&color=white&end=92&modestbranding=1" allowfullscreen></iframe>
</div>

<p>Hugo already provides a ton of shortcodes out of the box, like the one for images, with the <a href="https://gohugo.io/content-management/shortcodes/#figure">HTML5 figure element</a>. Unfortunately, this doesn’t allow you to add more than 1 version of the image. Which means you can’t provide a WebP and a jpg version in one image.</p>
<p>To make this possible, I have create the following shortcode to allow you to use 2 versions of the same image, a WebP version and another version of the image like a jpg or png image.</p>
<pre class="r"><code>{{ $image := .Get &quot;image&quot;}}
{{ $type_arr := split $image &quot;.&quot; }}
{{ $srcbase := index $type_arr 0 }}

&lt;figure&gt;
    &lt;picture&gt;
      &lt;source srcset=&quot;{{$srcbase}}.webp&quot; type=&quot;image/webp&quot;&gt;
    &lt;img src=&quot;{{.Get `image`}}&quot; alt=&quot;{{.Get `alt` }}&quot; defer&gt;
    &lt;/picture&gt;
    &lt;figcaption&gt;
    &lt;p class=&quot;caption&quot;&gt;{{.Get &quot;alt&quot; }}&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;</code></pre>
<p>As you can see, I also include the defer reference to the image for performance improvement. Learn more on using <a href="https://martijnvanvreeden.nl/10-ways-to-improve-your-hugo-website-performance/#chapter3">defer to improve performance</a> in my blog about website performance.</p>
<p>I’ve made this shortcode available in <a href="https://github.com/martijnvv/webp-integration-hugoio">a Github repository</a> as well.</p>
</div>
<div id="how-to-use-the-webp-shortcode" class="section level2">
<h2>How to use the WebP shortcode</h2>
<p>To use the WebP shortcode in your markdown page, you will first have to include the shortcode in your template file. Once this is done, follow these steps to use the shortcode on your site.</p>
<div id="create-2-versions-of-the-same-image" class="section level3">
<h3>1. Create 2 versions of the same image</h3>
<p>Instead of having just one version of an image (ie jpg or png), you will have to create a WebP version of the same image. There are <a href="https://webp-converter.com/">online tools</a> that can do this for you. Make sure to give them the exact same name, with the only difference being the file extension.</p>
</div>
<div id="upload-both-versions-of-the-image" class="section level3">
<h3>2. Upload both versions of the image</h3>
<p>Instead of just uploading your regular image, also upload the WebP version of the image. Add them both to the same folder.</p>
</div>
<div id="include-the-shortcode-in-your-markdown-file" class="section level3">
<h3>3. Include the shortcode in your markdown file</h3>
<p>Use the following shortcode to include the image to your page. I include an example you can also check out in the source code.</p>
<pre class="r"><code>blogdown::shortcode(&quot;webp&quot;, alt = &quot;A cute puppy to lighten your day&quot;, image = &#39;&quot;/img/puppy.jpg&quot;&#39;)</code></pre>




<figure>
	<picture>
	  <source srcset="/img/puppy.webp" type="image/webp">
	<img src="/img/puppy.jpg" alt="A cute puppy to lighten your day" defer>
	</picture>
	<figcaption>
	<p class="caption">A cute puppy to lighten your day</p>
	</figcaption>
</figure>
<p>The exact format of the shortcode depends on the platform you use. I run my website with blogdown.</p>
<p>The code includes the jpg version of the image as a fallback and automatically returns the puppy.webp version as the primary source the browser checks.</p>
</div>
</div>
<div id="using-other-next-gen-formats-than-webp" class="section level2">
<h2>Using other next-gen formats than WebP</h2>
<p>The shortcode is pretty simple. To add other next-gen image formats or replace WebP, simply add an additional source.</p>
<pre class="r"><code>{{ $image := .Get &quot;image&quot;}}
{{ $type_arr := split $image &quot;.&quot; }}
{{ $srcbase := index $type_arr 0 }}

&lt;figure&gt;
    &lt;picture&gt;
      &lt;source srcset=&quot;{{$srcbase}}.webp&quot; type=&quot;image/webp&quot;&gt;
    &lt;source srcset=&quot;{{$srcbase}}.jp2&quot; type=&quot;image/jp2&quot;&gt;
    &lt;img src=&quot;{{.Get `image`}}&quot; alt=&quot;{{.Get `alt` }}&quot; defer&gt;
    &lt;/picture&gt;
    &lt;figcaption&gt;
    &lt;p class=&quot;caption&quot;&gt;{{.Get &quot;alt&quot; }}&lt;/p&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;</code></pre>
</div>
</div>

      </article>
              
                <span class="post-meta" style="text-align:center">Tags: 
                  
                    #<a href="https://martijnvv.github.io/personal_blog/tags/hugo/" class="post-meta-tag-article">hugo</a>&nbsp;
                  
                </span>
              
		
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box">
    <ul class="share">
      
      <li>
        <a class="fs2" href="//twitter.com/share?url=https%3a%2f%2fmartijnvv.github.io%2fpersonal_blog%2fhugo-shortcode-to-serve-images-in-next-gen-formats%2f&amp;text=Hugo%20shortcode%20to%20serve%20images%20in%20next-gen%20formats&amp;via=martijnvv" target="_blank" title="Share on Twitter" rel="noreferrer" aria-label="share article on twitter">
          <i class="icon-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a class="fs2" href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmartijnvv.github.io%2fpersonal_blog%2fhugo-shortcode-to-serve-images-in-next-gen-formats%2f" target="_blank" title="Share on Facebook" rel="noreferrer" aria-label="share article on facebook">
          <i class="icon-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a class="fs2" href="//reddit.com/submit?url=https%3a%2f%2fmartijnvv.github.io%2fpersonal_blog%2fhugo-shortcode-to-serve-images-in-next-gen-formats%2f&amp;title=Hugo%20shortcode%20to%20serve%20images%20in%20next-gen%20formats" target="_blank" title="Share on Reddit" rel="noreferrer" aria-label="share article on reddit">
          <i class="icon-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a class="fs2" href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmartijnvv.github.io%2fpersonal_blog%2fhugo-shortcode-to-serve-images-in-next-gen-formats%2f&amp;title=Hugo%20shortcode%20to%20serve%20images%20in%20next-gen%20formats" target="_blank" title="Share on LinkedIn" rel="noreferrer" aria-label="share article on linkedin">
          <i class="icon-linkedin"></i>
        </a>
      </li>
      </li>
    </ul>
  </div>
  
              </div>
            </section>
        
	  <ul class="pager blog-pager">
        
          <li class="previous">
            <a href="https://martijnvv.github.io/personal_blog/10-ways-to-improve-your-hugo-website-performance/" data-toggle="tooltip" data-placement="top" title="10 Ways to improve your (Hugo) website performance">&larr; Previous Post</a>
          </li>
        
        
          <li class="next">
            <a href="https://martijnvv.github.io/personal_blog/10-things-you-need-to-know-about-the-new-google-app-web-analytics/" data-toggle="tooltip" data-placement="top" title="10 Things you need to know about the new Google Analytics 4">Next Post &rarr;</a>
          </li>
        
      </ul>

      
	  
    </div>
  </div>
</div>
    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
	            
        <ul class="list-inline text-center footer-links social_links">
		
              <li>
                <a href="https://twitter.com/martijnvv" title="Twitter" rel="noreferrer" aria-label="Twitter">
                  <span class="glyph fs1">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="glyph_config icon-twitter gl_inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.linkedin.com/in/martijnvanvreeden" title="LinkedIn" rel="noreferrer" aria-label="LinkedIn">
                  <span class="glyph fs1">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="glyph_config icon-linkedin gl_inverse"></i>
                  </span>
                </a>
              </li>
			<li>
                <a href="mailto:mail@martijnvanvreeden.nl" title="Email me" rel="noreferrer" aria-label="email me">
                  <span class="glyph fs1">
						<i class="fas fa-circle fa-stack-2x"></i>
						<i class="glyph_config icon-mail2 gl_inverse"></i>
                  </span>
                </a>
            </li>
        </ul>
        <p class="credits copyright text-muted">
              <a href="/cookie-policy/" rel="nofollow">Privacy policy</a>
          &nbsp;&bull;&nbsp;
          2023
          
            &nbsp;&bull;&nbsp;
            <a href="https://martijnvv.github.io/personal_blog/" rel="nofollow">Martijn van Vreeden</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
	<script src="https://martijnvv.github.io/personal_blog/js/main.js"></script>
	<script src="https://martijnvv.github.io/personal_blog/js/highlight.min.js"></script>
	<script src="https://martijnvv.github.io/personal_blog/js/purecookie.js"></script>
	<script> hljs.initHighlightingOnLoad(); </script>
	
	<noscript><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"></noscript>
  </body>
</html>

